<img src="https://github.com/Agzes/AHK-FOR-RPM/blob/main/!ReadMe/Header.png" alt="image" width="1000">
<a href="https://agzes.netlify.app/AHK-FOR-RPM/Editor">
    <img src="../!ReadMe/Editor.png" alt="image" width="1000">
</a>

<div align="center">
    <h2>
    Документация к AFR Editor
    </h2>

    DOCS BETA v.1.0 | v.2.2.0 AFR Editor

</div>

> [!Tip]
> 1. Не используйте запятые в названиях
> 2. Для каждого действия нужно создавать бинд (его можно оставить пустым, но описание нужно добавить) [он необходим для названия кнопок в окнах и т.д.]
> 3. В Custom версии бинд носит непрямой смысл, бинд нужен не только для того что определить бинд, а ещё и для того что-бы назвать действие

> [!warning]
> Editor и Документация находится в бете

---

## Содержание
- [Содержание](#содержание)
- [Введение](#введение)
- [Начало работы](#начало-работы)
  - [Создание нового конфига](#создание-нового-конфига)
- [Интерфейс редактора](#интерфейс-редактора)
  - [Вкладка "Переменные"](#вкладка-переменные)
  - [Вкладка "Бинды"](#вкладка-бинды)
  - [Вкладка "Параметры"](#вкладка-параметры)
  - [Вкладка "Отыгровки"](#вкладка-отыгровки)
  - [Вкладка "Списки"](#вкладка-списки)
  - [Вкладка "Окна"](#вкладка-окна)
  - [Вкладка "Настройки AFR"](#вкладка-настройки-afr)
  - [Вкладка "Экспорт \& Импорт"](#вкладка-экспорт--импорт)
- [Q\&A по Editor](#qa-по-editor)
  - [Как изменить порядок элементов?](#как-изменить-порядок-элементов)
  - [Как создать сложную отыгровку с несколькими действиями?](#как-создать-сложную-отыгровку-с-несколькими-действиями)
  - [Какие типы действий доступны в RPAction и в чём разница?](#какие-типы-действий-доступны-в-rpaction-и-в-чём-разница)
  - [Как использовать авто-заполнение?](#как-использовать-авто-заполнение)
  - [Как создать функцию на AHK?](#как-создать-функцию-на-ahk)
  - [Как добавить новое окно с отыгровками?](#как-добавить-новое-окно-с-отыгровками)
  - [Как обновить списки биндов после добавления новых биндов?](#как-обновить-списки-биндов-после-добавления-новых-биндов)
- [Дополнительные советы](#дополнительные-советы)
  - [Сохранение](#сохранение)
  - [Функции в отыгровках](#функции-в-отыгровках)
  - [Устранение неполадок](#устранение-неполадок)

## Введение

AFR Editor - это веб-инструмент для создания конфига AFR для Custom версии AHK-FOR-RPM

## Начало работы

### Создание нового конфига

1. На главной странице нажмите кнопку "Новый конфиг".
2. Введите название конфига (обязательно).
3. Введите название ревизии (по умолчанию "Custom"). `Ревизия подразумевает собой организацию`
4. Нажмите "Создать".

После создания конфига автоматически откроется редактор, где вы сможете настроить все параметры.

## Интерфейс редактора

Редактор конфига разделен на несколько вкладок, каждая из которых отвечает за определенный аспект конфигурации.

### Вкладка "Переменные"

Здесь настраиваются основные переменные конфига:

- **Версия АХК (для интерфейса)** - версия вашего конфига. (используется только в UI)
- **Кодовая версия (для авто-обновлений)** - числовое значение версии кода. (405 - отключит функцию)
- **Шрифт программы** - шрифт, используемый в интерфейсе (рекомендуется оставить Segoe UI).
- **Размер шрифта** - размер шрифта для интерфейса. (изменяйте если вы изменили шрифт)
- **Путь для настроек (в regedit)** - путь в реестре Windows для хранения настроек.
- **Название ревизии** - название конфига. `Ревизия подразумевает собой рп организацию для которой создан конфиг`
- **Высота фона в Конфигураторе биндов** - высота фона в пикселях для конфигуратора биндов.

### Вкладка "Бинды"

Здесь создаются и редактируются бинды (привязки сочетаний клавиш):

- Нажмите "Добавить бинд" для создания нового бинда.
- Для каждого бинда укажите:
  - **Название бинда** - уникальный идентификатор бинда (например, "Greetings").
  - **Комбинация клавиш** - клавиша или комбинация клавиш для активации (например, "Insert", "^F1" для Ctrl+F1). [Обязательно используйте синтаксис AutoHotKey v2] [[AHK v2 Docs | Горячие клавиши]](https://www.autohotkey.com/docs/v2/Hotkeys.htm#Symbols)
  - **Описание** - текстовое описание бинда. (отображается в Конфигураторе биндов)
- Бинды можно перетаскивать для изменения порядка с помощью иконки перетаскивания.
- Каждый бинд можно редактировать или удалять с помощью соответствующих кнопок.

### Вкладка "Параметры"

Здесь создаются параметры конфига, которые можно будет настраивать в интерфейсе AFR и использовать в отыгровках или логических функциях:

- Нажмите "Добавить параметр" для создания нового параметра.
- Для каждого параметра укажите:
  - **Тип параметра** - CheckBox (флажок) или Input (текстовое поле).
  - **Название параметра** - уникальный идентификатор параметра.
  - **Значение** - значение по умолчанию (для CheckBox: true/false).
  - **Отображаемое название** - название, которое будет отображаться в интерфейсе.
  - **Описание** - пояснение для пользователя.

### Вкладка "Отыгровки"

Здесь создаются отыгровки (действия, выполняемые при нажатии определенных клавиш):

- Нажмите "Добавить отыгровку" для создания новой отыгровки.
- Для каждой отыгровки укажите:
  - **Название отыгровки** - уникальный идентификатор.
  - **Название бинда** - бинд, к которому привязана отыгровка (который создаётся в вкладке "Бинды") (нужно выбрать из выпадающего списка).
  - **Тип** - RPAction (последовательность действий) или Func (функция на AHK v2).
  - **Содержимое** - зависит от типа:
    - Для RPAction: добавьте действия с помощью кнопки "Добавить действие". Для каждого действия укажите тип (Chat/AutoChat (бета)), текст, задержку до и после выполнения.
    - Для Func: введите код функции AHK.

Действия в RPAction можно перетаскивать для изменения порядка.

### Вкладка "Списки"

Здесь настраиваются списки биндов для различных целей:

- **Отсортированный список для конфигуратора биндов** - список биндов, которые будут доступны в конфигураторе.
- **Список для биндов** - список биндов для основного интерфейса (не включайте системные бинды).
- Кнопки "Сгенерировать список" автоматически создают списки на основе имеющихся биндов. (рекомендуется)

### Вкладка "Окна"

Здесь создаются окна интерфейса AFR:

- Нажмите "Добавить окно" для создания нового окна.
- Для каждого окна укажите:
  - **Тип окна** - тип окна (на данный момент всегда "Custom").
  - **Название окна** - уникальный идентификатор окна.
  - **Label в окне** - заголовок, отображаемый в окне. (`None` - убирает его)
  - **Название бинда** - бинд, который будет открывать это окно. (который создаётся в вкладке "Бинды")
  - **Элементы** - список отыгровок, которые будут доступны в этом окне (через запятую).

### Вкладка "Настройки AFR"

Здесь настраиваются системные функции AFR (на данный момент их 3): 

- Нажмите "Добавить настройку" для создания новой настройки.
- Для каждой настройки укажите:
  - **Тип** - AFR (для ForceStop/Menu) или SYS (для Restart).
  - **Название настройки** - Menu, ForceStop или Restart. (или любой ваш бинд)
  - **Название бинда** - бинд, к которому привязана настройка.

### Вкладка "Экспорт & Импорт"

Здесь можно экспортировать созданный конфиг или импортировать существующий:

- **Формат экспорта** - выберите формат:
  - AHK Script - для создания AHK скрипта.
  - JSON - для экспорта/импорта в AFR Editor.
- Нажмите "Копировать" для копирования кода выбранного типа в буфер обмена.
- Нажмите "Импорт (JSON)" для импорта конфига из JSON.
- Нажмите "Как собрать? (AHK)" что-бы перейти в [build.md](build.md).

## Q&A по Editor

### Как изменить порядок элементов?

Для изменения порядка биндов, параметров, отыгровок, окон или настроек AFR используйте иконку перетаскивания (⋮⋮) слева от элемента. Нажмите и удерживайте эту иконку, затем перетащите элемент в нужное положение.

### Как создать сложную отыгровку с несколькими действиями?

1. Создайте новую отыгровку с типом "RPAction".
2. Добавьте первое действие, указав его тип, текст и задержки.
3. Нажмите "Добавить действие" для добавления следующего действия.
4. Повторите для всех необходимых действий.
5. Используйте перетаскивание для изменения порядка действий.

### Какие типы действий доступны в RPAction и в чём разница?

- **Chat** - отправка сообщения в чат с указанными задержками до и после.
- **AutoChat** - автоматическая отправка сообщения (автоматически рассчитывает задержку).

### Как использовать авто-заполнение?

При вводе названия бинда или элемента в соответствующих полях появится выпадающий список с доступными вариантами. Нажмите на нужный вариант, чтобы выбрать его.

### Как создать функцию на AHK?

1. Создайте новую отыгровку с типом "Func".
2. В поле "Содержимое" введите код функции AHK, например:

```ahk
MyCustomFunction(Element?, *) {
    MsgBox("Это моя пользовательская функция")
    ; Тут так-же можно вызвать RPActions 
    ; RPActions([
    ;    ["Chat", "Текст", S100, S300]
    ; ])
    return
}
```

### Как добавить новое окно с отыгровками?

1. Создайте необходимые отыгровки на вкладке "Отыгровки".
2. Перейдите на вкладку "Окна" и нажмите "Добавить окно".
3. Укажите название, метку и бинд для открытия окна.
4. В поле "Элементы" через запятую перечислите названия отыгровок, которые должны быть доступны в этом окне.

### Как обновить списки биндов после добавления новых биндов?

Перейдите на вкладку "Списки" и нажмите кнопки "Сгенерировать список для конфигуратора" и "Сгенерировать список для биндов". Это автоматически обновит списки на основе текущих биндов.


## Дополнительные советы

### Сохранение

Хоть и Editor сохраняет данный в локальных файлах в вашем браузере, они могут очистится. Рекомендуется создавать резервные версии конфигов с экспортом в JSON (т.к. JSON легко можно импортировать в Editor)

### Функции в отыгровках

1. **Создание сложных функций** - в отыгровках типа "Func" можно создавать сложные функции с условиями, циклами и другими конструкциями AHK v2.
2. **Использование параметров в отыгровках** - параметры, созданные на вкладке "Параметры", можно использовать в функциях для настройки поведения отыгровок. `GBinds_cfg['название_вашего_параметра']`

### Устранение неполадок

1. **Проблемы с экспортом** - если при экспорте возникают ошибки, проверьте наличие специальных символов в названиях и описаниях.
2. **Отсутствие биндов в списках** - после добавления новых биндов не забывайте обновлять списки на вкладке "Списки".
3. **Проблемы с импортом** - убедитесь, что импортируемый JSON имеет правильный формат и содержит все необходимые поля.



# В случае проблем
создайте Issue на https://github.com/Agzes/AHK-FOR-RPM
